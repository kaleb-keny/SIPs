---
sip: 122
title: Multi-collateral Shorts v1.1 & Collapsible Loans
status: WIP
author: kaleb (@kaleb-keny), Jackson Chan (@jacko125)
discussions-to: TBD

created: 2021-03-05
---

## Simple Summary

Add improvements to the CollateralShort and Collateral contracts to allow partial liquidations without delay and collapsible short loans with v1.1.

## Abstract

This SIP proposes improving the sUSD short mechanism implemented in [SIP 103](https://sips.synthetix.io/sips/sip-103) by allowing liquidations without the loan interaction delays, improving the oracle sources for renBTC collateral and a new feature that allows synth short positions to be closed with the sUSD collateral locked against the short position.

## Motivation

Currently multi-collateral loans have an interaction delay of 1 hour which affects the liquidation of under-collateralised loans and short positions if they have been recently partially liquidated it would prevent the borrower or liquidation keepers from managing the loan. This delay mechanism for loan liquidations results in the borrower unable to fix their loan by repaying the borrowed synths.

Partial liquidations of under-collateralised loans and short positions should be able to bypass the interaction delay mechanism so that the loan can be liquidated or repaid by the borrower if it is under-collateralised.

Updating the renBTC collateral price feed to read from a renBTC-USD and BTC-USD reduces the assumption that renBTC collateral is the same value as BTC. In cases where renBTC deviates from the BTC price having a renBTC-USD price feed would reduce the risk to Synthetix protocol that the renBTC collateral is off peg from BTC prices.

Collapsible loans for short positions would allow liquidation keepers to liquidate the loans using the locked collateral when the collateral is also a synth, for example, sUSD is currently locked at 130% for short positions. Keepers don't need to actually buy the corresponding sBTC / sETH to repay the borrowed synths in the short position.

It would partially burn the sUSD collateral to fix the loan ratio to be above 130%, exchanging the sUSD collateral to repay the borrowed synth (sETH / sBTC) at the exchange rate. The liquidation penalty (10%) would be split between the reward pool and keepers, where 2.5% goes to the reward fee pool and 7.5% to the keeper.

The collapsible loans mechanism could be extended to allow short positions to be repaid from the sUSD collateral as it is over-collateralised. This allows the position to be repaid as an exchange of the locked sUSD for the sETH / sBTC that is borrowed.

## Specification

<!--The specification should describe the syntax and semantics of any new feature, there are five sections
1. Overview
2. Rationale
3. Technical Specification
4. Test Cases
5. Configurable Values
-->

### Overview

#### renBTC collateral price feed

renBTC is enabled as an ERC20 collateral for multi-collateral loans that can issue sBTC and sUSD.

In extreme situations where renBTC becomes off-peg to BTC, the collateral should reflect the lower bound of the renBTC price.

This SIP will require renBTC as a currencyKey added to the `ExchangeRates` contract which will provide the aggregated oracle price feed.

#### Collapsible Loans


### Rationale

### Technical Specification

- `collateral.liquidateInternal()` skips the 1 hour interaction delay mechanism.

- Update `event LoanDrawnDown(address indexed account, uint id, uint amount, uint loanAmountAfter)` to add loanAmountAfter in event.

- Update CollateralShort contract names to include ERC20 token name

- Opening loans with renBTC collateral via `CollateralErc20` contract will request `renBTC-USD` and `BTC-USD` prices. The lower of the price would be used as the effective exchangeRate for the collateral. The `Collateral.sol` contract will determine the price for renBTC and BTC from Chainlink feeds, taking the min(renBTC-USD, BTC-USD) and passing this to the `collateral.openInternal()` function passing in the effective collateral rate.

### Test Cases

Included with implementation.

### Configurable Values (Via SCCP)

- Keeper reward % for liquidation using collapsible loans (75% of liquidation penalty)
- Reward pool % for liquidation using collapsible loans (25% of liquidation penalty)

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).